# cu-hsl-ral-withdrawal

## Prerequisites
The the following folders and files set up prior to execution:
- `input` - folder where any "input" excel spreadsheets will be stored
    - `faculty_keep_lists` - folder where the **faculty_keep_masterlist.xlsx** file should be stored
        > **faculty_keep_masterlist.xlsx** must have the following columns, at minimum:
        > - Barcode
        > - Faculty
    - `lib_guide_title_lists` - folder where all original title lists should be stored
        > Each title list must have the following columns, at minimum:
        > - Barcode
        > - Worldcat OCLC Number
- `output` - folder where any "output" files generated by the program will be saved
    - `pull_withdraw_lists` - folder where the final "Pull & Withdraw" list files will be saved
    - `pull_transfer_lists` - folder where the final "Pull & Transfer" file will be saved
    - `log_lists` - folder where log files will be saved (not found records when running program with `--include-log` flag)

```bash
├── input
│   ├── faculty_keep_lists
│   │   └── faculty_keep_masterlist.xlsx
│   │   
│   └── lib_guide_title_lists
│       ├── A_general_works.xlsx
│       ├── B_philosophy_general.xlsx
│       ├── ...              
│       └── WA_public_health.xlsx
│   
├── output
│   ├── pull_withdraw_lists
│   ├── pull_transfer_lists
│   └── log_lists
│
├── build
│   └── ral-pull-transfer
│       ├── ral-pull-transfer.exe.manifest
│       ├── ...              
│       └── ral-pull-transfer.pkg
│
├── dist
│   └── ral-pull-transfer.exe
│
└── ral-pull-transfer.py
```


## Running Locally

For users who wish to modify the Python scripts and execute each individually, you may use the following commands to run the script via command line:

```Bash
# create new virtual environment
python -m venv env

# activate virtual environment
source env\bin\activate

# install dependencies
pip install -r requirements.txt

# execute program
python <filename.py>
```  

## Running Pre-Compiled Executables
For other users who wish to run the code for creating the pull/transfer lists (**ral-pull-transfer.exe**), ***ALL*** directories (and executables including the **build** and **dist** folders) must be set according to the structure above before running through the following steps:

1.  Open Windows Command Prompt
    - Press the Windows key and search for "Command Prompt"
    - Alternatively, you may also open File Explorer to navigate to the folder where you have the repository saved, click the far right of the top filepath breadcrumb menu, type in `cmd` and press `Enter` on your keyboard
        - This will open a Command Prompt window from your current folder
2.  Execute the following commands:
    ```Bash
    # 1) change into the directory where the code is stored
    cd <Your-Path-Here>\cu-hsl-ral-withdrawal

    # 2) run the program
    .\dist\ral-pull-transfer.exe

    # There are a few other options you may use with the program:
    # 2a) run the program to locate and remove the barcodes (no logging included)
    .\dist\ral-pull-transfer.exe

    # 2b) run the log generator only
    .\dist\ral-pull-transfer.exe --log-only

    # 2c) run both of the previous options sequentially
    .\dist\ral-pull-transfer.exe --include-log
    ```
    
>Note: 
> - Depending on the amount of files (and records in the files) being processed, the program may take anywhere from several minutes to several hours to run.  
>  - You will know it is complete when you see a message like the following: `[Processing time: xyz sec]`.  
> - Also pay attention to any runtime errors/exceptions that may cause the program execution to fail.  These will the require action by the user to potentially fix some issue (whether it be formatting or some other anomaly) and manually execute the program again.
> - Ensure you have completed the pre-requisite steps before executing the script.